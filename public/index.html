<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>My First Golf Club</title>
  <link rel="stylesheet" href="/styles.css" />

  <!-- Leaflet CSS (free OSM map) -->
  <link
    rel="stylesheet"
    href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
    integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
    crossorigin=""
  />
  <!-- MarkerCluster CSS -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.5.3/dist/MarkerCluster.css" />
  <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.5.3/dist/MarkerCluster.Default.css" />

  <script defer src="https://challenges.cloudflare.com/turnstile/v0/api.js" async></script>
</head>
<body>
  <header class="site-header">
    <h1>My First Golf Club</h1>
    <p>Explore where golfers around the world played their first full round — and add your story.</p>
  </header>

  <!-- MAP -->
  <section id="map-section" class="card wide">
    <div id="map"></div>
  </section>

  <!-- STATS -->
  <section id="stats-section" class="card">
    <h2>Community stats</h2>
    <div class="stats-grid">
      <div class="stat">
        <div class="stat-label">Total users</div>
        <div class="stat-value" id="stat-total">—</div>
      </div>
      <div class="stat">
        <div class="stat-label">Average starting age</div>
        <div class="stat-value" id="stat-avg-age">—</div>
      </div>
      <div class="stat">
        <div class="stat-label">Most popular countries</div>
        <div class="stat-value" id="stat-top-countries">—</div>
      </div>
    </div>
  </section>

  <!-- FORM -->
  <section class="card">
    <h2>Share your first-round story</h2>
    <form id="mfgc-form" method="post" action="/api/submissions" enctype="multipart/form-data">
      <div class="grid">
        <label>First name
          <input name="firstName" required placeholder="Your first name" />
        </label>
        <label>Last initial
          <input name="lastInitial" maxlength="3" placeholder="First letter(s) of your surname (e.g., T)" />
        </label>
      </div>

      <div class="grid">
        <label>City where you played your first round
          <input name="city" placeholder="e.g., St Andrews, Nairobi, Melbourne" />
        </label>
        <label>Country of the course (where you first played)
          <div class="field-relative">
            <input name="country" id="country" autocomplete="off" placeholder="Start typing a country…" required />
            <div id="country-suggestions" class="ac-list" role="listbox" style="display:none"></div>
          </div>
        </label>
      </div>

      <div class="grid">
        <label>Your home country (for your player-card flag)
          <div class="field-relative">
            <input name="homeCountry" id="homeCountry" autocomplete="off" placeholder="Start typing a country…" required />
            <div id="home-country-suggestions" class="ac-list" role="listbox" style="display:none"></div>
          </div>
        </label>
        <label>Dream golf course
          <input name="dreamCourse" placeholder="e.g., St Andrews, Augusta National" />
        </label>
      </div>

      <label>Golf club / course name where you played your first round
        <input name="firstGolfClub" required placeholder="e.g., Royal Nairobi Golf Club" />
      </label>

      <label>When was your first round? (Month & Year)</label>
      <div class="grid">
        <select id="yearSelect" class="ym-select" aria-label="Year"></select>
        <select id="monthSelect" class="ym-select" aria-label="Month"></select>
      </div>
      <input type="hidden" name="firstRoundDate" id="firstRoundDate" />

      <div class="grid">
        <label>Age when you started
          <input name="ageWhenStarted" type="number" min="3" max="100" placeholder="e.g., 12" />
        </label>
        <label>How did you get into golf? (optional)
          <input name="howGotIntoGolf" placeholder="e.g., A friend invited me / Inspired by TV / Family tradition" />
        </label>
      </div>

      <label>Short story (optional)
        <textarea name="story" maxlength="2000" placeholder="Share a highlight or memory from that first round…"></textarea>
      </label>

      <label>Photo (optional)
        <input type="file" name="photo" accept="image/*" />
      </label>

      <!-- Mini map picker (drag marker if geocode is off) -->
      <div class="mini-picker">
        <p class="map-subnote">If the dot is off, drag the marker to the exact course location.</p>
        <div id="picker-map"></div>
      </div>

      <!-- Hidden: map coordinates -->
      <input type="hidden" name="lat" id="lat" />
      <input type="hidden" name="lng" id="lng" />

      <!-- Big inline consent checkbox -->
      <div class="consent-row">
        <input type="checkbox" id="consentMapPin" name="consentMapPin" required />
        <label for="consentMapPin" class="consent-label">
          I’m happy for a pin to appear on the map for this submission.
        </label>
      </div>

      <div class="cf-turnstile" data-sitekey="0x4AAAAAAB5r0dz4fZGQZB2z"></div>

      <button type="submit" class="btn">Submit</button>
      <p id="status" class="status"></p>
    </form>
  </section>

  <!-- Leaflet JS + Clustering -->
  <script
    src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
    integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
    crossorigin=""
  ></script>
  <script src="https://unpkg.com/leaflet.markercluster@1.5.3/dist/leaflet.markercluster.js"></script>

  <!-- App logic -->
  <script src="/site.js"></script>
  <script src="/form-enhancements.js"></script>
</body>
</html>
